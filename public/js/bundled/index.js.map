{"mappings":"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","sources":["public/js/mapbox.js","public/js/alerts.js","public/js/updateSettings.js","public/js/index.js","public/js/login.js","public/js/stripe.js"],"sourcesContent":["/* eslint-disable */\r\nexport const displayMap = (locations) => {\r\n  mapboxgl.accessToken = 'pk.eyJ1Ijoiam9uYXNzY2htZWR0bWFubiIsImEiOiJjam54ZmM5N3gwNjAzM3dtZDNxYTVlMnd2In0.ytpI7V7w7cyT1Kq5rT9Z1A';\r\n\r\n  var map = new mapboxgl.Map({\r\n    container: 'map',\r\n    style: 'mapbox://styles/jonasschmedtmann/cjvi9q8jd04mi1cpgmg7ev3dy',\r\n    scrollZoom: false,\r\n    // center: [-118.11, 34.11],\r\n    // zoom: 10,\r\n    // interactive: false\r\n  });\r\n\r\n  const bounds = new mapboxgl.LatLngBounds();\r\n\r\n  locations.forEach(loc => {\r\n    // Create marker\r\n    const el = document.createElement('div');\r\n    el.className = 'marker';\r\n\r\n    // Add marker\r\n    new mapboxgl.Marker({\r\n      element: el, \r\n      anchor: 'bottom',\r\n    }).setLngLat(loc.coordinates).addTo(map);\r\n\r\n    // Add popup\r\n    new mapboxgl.Popup({\r\n      offset: 30\r\n    })\r\n      .setLngLat(loc.coordinates)\r\n      .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\r\n      .addTo(map);\r\n\r\n    // Extend map bounds to include current location\r\n    bounds.extend(loc.coordinates);\r\n  });\r\n\r\n  map.fitBounds(bounds, {\r\n    padding: {\r\n      top: 200,\r\n      bottom: 150,\r\n      left: 100,\r\n      right: 100,\r\n    },\r\n  });\r\n};","/* eslint-disable */\r\n\r\nexport const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) { \r\n    el.parentElement.removeChild(el);\r\n  }\r\n}\r\n\r\n// type is 'success' or 'error'\r\nexport const showAlert = (type, msg) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, 5000);\r\n};","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\n// type is either 'password' or 'data'\r\nexport const updateSettings = async (data, type) => {\r\n  try {\r\n    const url = \r\n      type === 'password' \r\n        ? '/api/v1/users/updateMyPassword'\r\n        : '/api/v1/users/updateMe';\r\n\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', `${type.toUpperCase()} updated successfully`);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};","/* eslint-disable */\nimport '@babel/polyfill';\nimport { displayMap } from './mapbox';\nimport { login, logout } from './login';\nimport { updateSettings } from './updateSettings';\nimport { bookTour } from './stripe';\n\n// DOM ELEMENTS\nconst mapBox = document.getElementById('map');\nconst loginForm = document.querySelector('.form--login');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst userDataForm = document.querySelector('.form-user-data');\nconst userPasswordForm = document.querySelector('.form-user-password');\nconst bookBtn = document.getElementById('book-tour');\n\n// DELEGATION\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\n\nif (loginForm)\n  loginForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    login(email, password);\n    console.log(\"Sardor\");\n  });\n\nif (logOutBtn) {  \n  logOutBtn.addEventListener('click', logout);\n}\n\nif (userDataForm) {\n  userDataForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const form = new FormData();\n    form.append('name', document.getElementById('name').value );\n    form.append('email', document.getElementById('email').value );\n    form.append('photo', document.getElementById('photo').files[0]);\n    // console.log(form);\n\n    updateSettings(form, 'data');\n  });\n}\n\nif (userPasswordForm) {\n  userPasswordForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\n\n    const passwordCurrent = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    await updateSettings(\n      { passwordCurrent, password, passwordConfirm },\n      'password'\n    );\n\n    document.querySelector('.btn--save-password').textContent = 'Save password';\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n  });\n}\n\nif (bookBtn) {\n  bookBtn.addEventListener('click', (e) => {\n    e.target.textContent = 'Processing...';\n    const { tourId } = e.target.dataset;\n    bookTour(tourId);\n  });\n}","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password\r\n      }\r\n    });\r\n\r\n    if (res.data.status === 'success') { \r\n      showAlert('success', 'Logged in successfully!');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: '/api/v1/users/logout',\r\n    });\r\n\r\n    if (res.data.status = 'success') {\r\n      location.reload(true);\r\n    }\r\n  } catch(err) {\r\n    showAlert('error', 'Error logging out! Try again.');\r\n  }\r\n};\r\n","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const bookTour = async (tourId) => {\r\n  const stripe = Stripe('pk_test_51N9KXcJcWjJ4YG45ujZJwf5nLKyjvswEcL6g4yaWnXTHknjwKLKyf5IhWjCzxM566YHUdzsBuID6lx2hBxIbvbAq005Y0nK9b8');\r\n  try {\r\n    // 1) Get checkout session from API\r\n    const session = await axios(\r\n      `/api/v1/bookings/checkout-session/${tourId}`\r\n    );\r\n    console.log(session);\r\n\r\n    // 2) Create checkout form + charge credit card\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  } catch(err) {\r\n    console.log(err);\r\n    showAlert('error', err);\r\n  }\r\n};"],"names":["$b01db4da9d111652$export$5a81baf3e1f8b5bb","el","document","querySelector","parentElement","removeChild","$b01db4da9d111652$export$e2ed28791945543d","type","msg","markup","insertAdjacentHTML","window","setTimeout","$baec1ded6f001e5d$export$81acc09c7bdb4525","async","data","url","$parcel$interopDefault","$ct7a6$axios","method","status","toUpperCase","err","response","message","$e90d12d35cb48c24$var$mapBox","getElementById","$e90d12d35cb48c24$var$loginForm","$e90d12d35cb48c24$var$logOutBtn","$e90d12d35cb48c24$var$userDataForm","$e90d12d35cb48c24$var$userPasswordForm","$e90d12d35cb48c24$var$bookBtn","locations","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LatLngBounds","forEach","loc","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","bottom","left","right","$1c25fba746cc31ee$export$976c4dce80bbf3f7","JSON","parse","dataset","addEventListener","e","preventDefault","email","password","location","assign","$212ec473d5bf09c9$export$4a142f624dd0fa8","value","console","log","reload","form","FormData","append","files","textContent","passwordCurrent","passwordConfirm","target","tourId","stripe","Stripe","session","redirectToCheckout","sessionId","id","$5b30c8a71ad7f90c$export$54ca10ceadf03905"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}