{"mappings":"mGACO,MCCMA,EAAS,KACpB,MAAMC,EAAKC,SAASC,cAAa,UAC7BF,GACFA,EAAGG,cAAcC,YAAYJ,EAAE,EAKtBK,EAAS,CAAIC,EAAMC,EAAKC,EAAO,KAC1CT,IACA,MAAMU,EAAM,4BAA+BH,MAASC,UACpDN,SAASC,cAAa,QAASQ,mBAAkB,aAAeD,GAChEE,OAAOC,WAAWb,EAAkB,IAAPS,EAAW,ECT7BK,EAAcC,MAAUC,EAAMT,K,IAEvC,MAAMU,EACA,aAAJV,EAAmB,iCACiB,yBASnB,mBANDW,EAAAC,EAAAD,CAAK,CACrBE,OAAM,Q,IACNH,E,KACAD,KAGMA,KAAKK,QACXf,EAAS,UAAU,GAAKC,EAAKe,qCAEjC,CAAC,MAAQC,GACPjB,EAAS,QAAUiB,EAAIC,SAASR,KAAKS,QACvC,GCfIC,EAASxB,SAASyB,eAAc,OAChCC,EAAY1B,SAASC,cAAa,gBAClC0B,EAAY3B,SAASC,cAAa,oBAClC2B,EAAe5B,SAASC,cAAa,mBACrC4B,EAAmB7B,SAASC,cAAa,uBACzC6B,EAAU9B,SAASyB,eAAc,aAGvC,GAAID,EAAQ,CHfW,CAAIO,IACzBC,SAASC,YAAW,wGAEpB,IAAIC,EAAM,IAAIF,SAASG,IAAG,CACxBC,UAAS,MACTC,MAAK,6DACLC,YAAY,IAMd,MAAMC,EAAS,IAAIP,SAASQ,aAE5BT,EAAUU,SAAQC,IAEhB,MAAM3C,EAAKC,SAAS2C,cAAa,OACjC5C,EAAG6C,UAAS,SAGZ,IAAIZ,SAASa,OAAM,CACjBC,QAAS/C,EACTgD,OAAM,WACLC,UAAUN,EAAIO,aAAaC,MAAMhB,GAGpC,IAAIF,SAASmB,MAAK,CAChBC,OAAQ,KAEPJ,UAAUN,EAAIO,aACdI,QAAO,UAAWX,EAAIY,QAAQZ,EAAIa,mBAClCL,MAAMhB,GAGTK,EAAOiB,OAAOd,EAAIO,YAAW,IAG/Bf,EAAIuB,UAAUlB,EAAM,CAClBmB,QAAO,CACLC,IAAK,IACLC,OAAQ,IACRC,KAAM,IACNC,MAAO,M,EGzBXC,CADkBC,KAAKC,MAAMzC,EAAO0C,QAAQnC,WAE9C,CAEIL,GACFA,EAAUyC,iBAAgB,UAAYC,IACpCA,EAAEC,iBCnBYxD,OAAUyD,EAAOC,K,IAWZ,mBATDvD,EAAAC,EAAAD,CAAK,CACrBE,OAAM,OACNH,IAAG,sBACHD,KAAI,C,MACFwD,E,SACAC,MAIIzD,KAAKK,SACXf,EAAS,UAAU,2BACnBM,OAAOC,YAAU,KACf6D,SAASC,OAAM,IAAI,GAClB,MAEP,CAAC,MAAQpD,GACPjB,EAAS,QAAUiB,EAAIC,SAASR,KAAKS,QACvC,GDGEmD,CAFc1E,SAASyB,eAAc,SAAUkD,MAC9B3E,SAASyB,eAAc,YAAakD,MAChC,IAGrBhD,GACFA,EAAUwC,iBAAgB,SCJTtD,U,WAEGG,EAAAC,EAAAD,CAAK,CACrBE,OAAM,MACNH,IAAG,0BAGGD,KAAKK,OAAM,UACjBqD,SAASI,QAAO,EAEpB,CAAC,MAAOvD,GACNjB,EAAS,QAAQ,gCACnB,KDLEwB,GACFA,EAAauC,iBAAgB,UAAYC,IACvCA,EAAEC,iBACF,MAAMQ,EAAO,IAAIC,SACjBD,EAAKE,OAAM,OAAS/E,SAASyB,eAAc,QAASkD,OACpDE,EAAKE,OAAM,QAAU/E,SAASyB,eAAc,SAAUkD,OACtDE,EAAKE,OAAM,QAAU/E,SAASyB,eAAc,SAAUuD,MAAM,IAG5DpE,EAAeiE,EAAI,OAAQ,IAI3BhD,GACFA,EAAiBsC,iBAAgB,UAAStD,MAASuD,IACjDA,EAAEC,iBACFrE,SAASC,cAAa,uBAAwBgF,YAAW,cAEzD,MAAMC,EAAkBlF,SAASyB,eAAc,oBAAqBkD,MAC9DJ,EAAWvE,SAASyB,eAAc,YAAakD,MAC/CQ,EAAkBnF,SAASyB,eAAc,oBAAqBkD,YAC9D/D,EAAc,C,gBAChBsE,E,SAAiBX,E,gBAAUY,G,YAI/BnF,SAASC,cAAa,uBAAwBgF,YAAW,gBACzDjF,SAASyB,eAAc,oBAAqBkD,MAAK,GACjD3E,SAASyB,eAAc,YAAakD,MAAK,GACzC3E,SAASyB,eAAc,oBAAqBkD,MAAK,MAIjD7C,GACFA,EAAQqC,iBAAgB,SAAWC,IACjCA,EAAEgB,OAAOH,YAAW,gBACpB,MAAKI,OAAGA,GAAWjB,EAAEgB,OAAOlB,QEjEXrD,OAAUwE,IAC7B,MAAMC,EAASC,OAAM,+G,IAGnB,MAAMC,QAAgBxE,EAAAC,EAAAD,CAAK,qCACYqE,KAEvCI,QAAQC,IAAIF,SAGNF,EAAOK,mBAAkB,CAC7BC,UAAWJ,EAAQ1E,KAAK0E,QAAQK,IAEpC,CAAC,MAAOxE,GACNoE,QAAQC,IAAIrE,GACZjB,EAAS,QAAUiB,EACrB,GFkDEyE,CAAST,EAAM,IAInB,MAAMU,EAAe/F,SAASC,cAAa,QAASiE,QAAQ8B,MAExDD,GACFE,UAAS,UAAYF,EAAc","sources":["public/js/mapbox.js","public/js/alerts.js","public/js/updateSettings.js","public/js/index.js","public/js/login.js","public/js/stripe.js"],"sourcesContent":["/* eslint-disable */\r\nexport const displayMap = (locations) => {\r\n  mapboxgl.accessToken = 'pk.eyJ1Ijoiam9uYXNzY2htZWR0bWFubiIsImEiOiJjam54ZmM5N3gwNjAzM3dtZDNxYTVlMnd2In0.ytpI7V7w7cyT1Kq5rT9Z1A';\r\n\r\n  var map = new mapboxgl.Map({\r\n    container: 'map',\r\n    style: 'mapbox://styles/jonasschmedtmann/cjvi9q8jd04mi1cpgmg7ev3dy',\r\n    scrollZoom: false,\r\n    // center: [-118.11, 34.11],\r\n    // zoom: 10,\r\n    // interactive: false\r\n  });\r\n\r\n  const bounds = new mapboxgl.LatLngBounds();\r\n\r\n  locations.forEach(loc => {\r\n    // Create marker\r\n    const el = document.createElement('div');\r\n    el.className = 'marker';\r\n\r\n    // Add marker\r\n    new mapboxgl.Marker({\r\n      element: el, \r\n      anchor: 'bottom',\r\n    }).setLngLat(loc.coordinates).addTo(map);\r\n\r\n    // Add popup\r\n    new mapboxgl.Popup({\r\n      offset: 30\r\n    })\r\n      .setLngLat(loc.coordinates)\r\n      .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\r\n      .addTo(map);\r\n\r\n    // Extend map bounds to include current location\r\n    bounds.extend(loc.coordinates);\r\n  });\r\n\r\n  map.fitBounds(bounds, {\r\n    padding: {\r\n      top: 200,\r\n      bottom: 150,\r\n      left: 100,\r\n      right: 100,\r\n    },\r\n  });\r\n};","/* eslint-disable */\r\n\r\nexport const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) { \r\n    el.parentElement.removeChild(el);\r\n  }\r\n}\r\n\r\n// type is 'success' or 'error'\r\nexport const showAlert = (type, msg, time = 7) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, time * 1000);\r\n};","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\n// type is either 'password' or 'data'\r\nexport const updateSettings = async (data, type) => {\r\n  try {\r\n    const url = \r\n      type === 'password' \r\n        ? '/api/v1/users/updateMyPassword'\r\n        : '/api/v1/users/updateMe';\r\n\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', `${type.toUpperCase()} updated successfully`);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};","/* eslint-disable */\nimport '@babel/polyfill';\nimport { displayMap } from './mapbox';\nimport { login, logout } from './login';\nimport { updateSettings } from './updateSettings';\nimport { bookTour } from './stripe';\n\n// DOM ELEMENTS\nconst mapBox = document.getElementById('map');\nconst loginForm = document.querySelector('.form--login');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst userDataForm = document.querySelector('.form-user-data');\nconst userPasswordForm = document.querySelector('.form-user-password');\nconst bookBtn = document.getElementById('book-tour');\n\n// DELEGATION\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\n\nif (loginForm)\n  loginForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    login(email, password);\n  });\n\nif (logOutBtn) {  \n  logOutBtn.addEventListener('click', logout);\n}\n\nif (userDataForm) {\n  userDataForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const form = new FormData();\n    form.append('name', document.getElementById('name').value );\n    form.append('email', document.getElementById('email').value );\n    form.append('photo', document.getElementById('photo').files[0]);\n    // console.log(form);\n\n    updateSettings(form, 'data');\n  });\n}\n\nif (userPasswordForm) {\n  userPasswordForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\n\n    const passwordCurrent = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    await updateSettings(\n      { passwordCurrent, password, passwordConfirm },\n      'password'\n    );\n\n    document.querySelector('.btn--save-password').textContent = 'Save password';\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n  });\n}\n\nif (bookBtn) {\n  bookBtn.addEventListener('click', (e) => {\n    e.target.textContent = 'Processing...';\n    const { tourId } = e.target.dataset;\n    bookTour(tourId);\n  });\n}\n\nconst alertMessage = document.querySelector('body').dataset.alert;\n\nif (alertMessage) {\n  showAlert('success', alertMessage, 20);\n}","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password\r\n      }\r\n    });\r\n\r\n    if (res.data.status === 'success') { \r\n      showAlert('success', 'Logged in successfully!');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: '/api/v1/users/logout',\r\n    });\r\n\r\n    if (res.data.status = 'success') {\r\n      location.reload(true);\r\n    }\r\n  } catch(err) {\r\n    showAlert('error', 'Error logging out! Try again.');\r\n  }\r\n};\r\n","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const bookTour = async (tourId) => {\r\n  const stripe = Stripe('pk_test_51N9KXcJcWjJ4YG45ujZJwf5nLKyjvswEcL6g4yaWnXTHknjwKLKyf5IhWjCzxM566YHUdzsBuID6lx2hBxIbvbAq005Y0nK9b8');\r\n  try {\r\n    // 1) Get checkout session from API\r\n    const session = await axios(\r\n      `/api/v1/bookings/checkout-session/${tourId}`\r\n    );\r\n    console.log(session);\r\n\r\n    // 2) Create checkout form + charge credit card\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  } catch(err) {\r\n    console.log(err);\r\n    showAlert('error', err);\r\n  }\r\n};"],"names":["$b01db4da9d111652$export$5a81baf3e1f8b5bb","el","document","querySelector","parentElement","removeChild","$b01db4da9d111652$export$e2ed28791945543d","type","msg","time","markup","insertAdjacentHTML","window","setTimeout","$baec1ded6f001e5d$export$81acc09c7bdb4525","async","data","url","$parcel$interopDefault","$ct7a6$axios","method","status","toUpperCase","err","response","message","$e90d12d35cb48c24$var$mapBox","getElementById","$e90d12d35cb48c24$var$loginForm","$e90d12d35cb48c24$var$logOutBtn","$e90d12d35cb48c24$var$userDataForm","$e90d12d35cb48c24$var$userPasswordForm","$e90d12d35cb48c24$var$bookBtn","locations","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LatLngBounds","forEach","loc","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","bottom","left","right","$1c25fba746cc31ee$export$976c4dce80bbf3f7","JSON","parse","dataset","addEventListener","e","preventDefault","email","password","location","assign","$212ec473d5bf09c9$export$4a142f624dd0fa8","value","reload","form","FormData","append","files","textContent","passwordCurrent","passwordConfirm","target","tourId","stripe","Stripe","session","console","log","redirectToCheckout","sessionId","id","$5b30c8a71ad7f90c$export$54ca10ceadf03905","$e90d12d35cb48c24$var$alertMessage","alert","showAlert"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}